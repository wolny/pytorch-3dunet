2022-05-16 15:13:53,685 [MainThread] INFO ConfigLoader - Using 'cuda:0' device
2022-05-16 15:13:53,685 [MainThread] INFO TrainingSetup - {'manual_seed': 0, 'model': {'name': 'UNet3D', 'in_channels': 5, 'out_channels': 5, 'layer_order': 'cr', 'f_maps': 32, 'num_groups': 4, 'final_sigmoid': True, 'is_segmentation': True}, 'trainer': {'checkpoint_dir': '/net/fs01/work01/yasuda/data/multi/', 'resume': None, 'pre_trained': None, 'validate_after_iters': 1000, 'log_after_iters': 100, 'max_num_epochs': 200, 'max_num_iterations': 60000, 'eval_score_higher_is_better': True}, 'optimizer': {'learning_rate': 0.0002, 'weight_decay': 0.0001}, 'loss': {'name': 'DiceLoss', 'weight': None, 'ignore_index': None}, 'eval_metric': {'name': 'MeanIoU', 'ignore_index': None}, 'lr_scheduler': {'name': 'MultiStepLR', 'milestones': [10, 30, 60], 'gamma': 0.2}, 'loaders': {'dataset': 'StandardHDF5Dataset', 'batch_size': 1, 'num_workers': 4, 'raw_internal_path': 'raw', 'label_internal_path': 'label', 'weight_internal_path': None, 'train': {'file_paths': ['/net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_4.h5', '/net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_7.h5'], 'slice_builder': {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}, 'transformer': {'raw': [{'name': 'Standardize'}, {'name': 'RandomFlip'}, {'name': 'RandomRotate90'}, {'name': 'RandomRotate', 'axes': [[2, 1]], 'angle_spectrum': 15, 'mode': 'reflect'}, {'name': 'ElasticDeformation', 'spline_order': 3}, {'name': 'RandomContrast'}, {'name': 'AdditiveGaussianNoise'}, {'name': 'AdditivePoissonNoise'}, {'name': 'ToTensor', 'expand_dims': True}], 'label': [{'name': 'RandomFlip'}, {'name': 'RandomRotate90'}, {'name': 'RandomRotate', 'axes': [[2, 1]], 'angle_spectrum': 15, 'mode': 'reflect'}, {'name': 'ElasticDeformation', 'spline_order': 0}, {'name': 'ToTensor', 'expand_dims': True}]}}, 'val': {'file_paths': ['/net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_4.h5', '/net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_7.h5'], 'slice_builder': {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}, 'transformer': {'raw': [{'name': 'Standardize'}, {'name': 'ToTensor', 'expand_dims': True}], 'label': [{'name': 'ToTensor', 'expand_dims': True}]}}}, 'device': device(type='cuda', index=0)}
2022-05-16 15:13:53,685 [MainThread] INFO TrainingSetup - Seed the RNG for all devices with 0
2022-05-16 15:13:55,080 [MainThread] INFO UNet3DTrainer - Using 4 GPUs for training
2022-05-16 15:13:55,080 [MainThread] INFO UNet3DTrainer - Sending the model to 'cuda:0'
2022-05-16 15:13:57,414 [MainThread] INFO UNet3DTrainer - Number of learnable params 4081573
2022-05-16 15:13:57,416 [MainThread] INFO Dataset - Creating training and validation set loaders...
2022-05-16 15:13:58,854 [MainThread] INFO HDF5Dataset - Loading train set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_4.h5...
2022-05-16 15:13:59,350 [MainThread] INFO HDF5Dataset - Input stats: min=0, max=255, mean=129.334027973919, std=6.1305032261307915
2022-05-16 15:13:59,374 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:13:59,675 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:13:59,676 [MainThread] INFO HDF5Dataset - Loading train set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_7.h5...
2022-05-16 15:14:00,127 [MainThread] INFO HDF5Dataset - Input stats: min=1, max=217, mean=129.28665717193536, std=5.647814388387516
2022-05-16 15:14:00,150 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:14:00,371 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:14:00,396 [MainThread] INFO HDF5Dataset - Loading val set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_4.h5...
2022-05-16 15:14:00,858 [MainThread] INFO HDF5Dataset - Input stats: min=0, max=255, mean=129.334027973919, std=6.1305032261307915
2022-05-16 15:14:00,886 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:14:01,050 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:14:01,051 [MainThread] INFO HDF5Dataset - Loading val set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_7.h5...
2022-05-16 15:14:01,502 [MainThread] INFO HDF5Dataset - Input stats: min=1, max=217, mean=129.28665717193536, std=5.647814388387516
2022-05-16 15:14:01,530 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:14:01,712 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:14:01,713 [MainThread] INFO Dataset - Number of workers for train/val dataloader: 4
2022-05-16 15:14:01,713 [MainThread] INFO Dataset - 4 GPUs available. Using batch_size = 4 * 1
2022-05-16 15:14:01,713 [MainThread] INFO Dataset - Batch size for train/val loader: 4
2022-05-16 15:14:01,714 [MainThread] INFO UNet3DTrainer - DataParallel(
  (module): UNet3D(
    (encoders): ModuleList(
      (0): Encoder(
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(5, 16, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(16, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
        )
      )
      (1): Encoder(
        (pooling): MaxPool3d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(32, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
        )
      )
      (2): Encoder(
        (pooling): MaxPool3d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(64, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
        )
      )
      (3): Encoder(
        (pooling): MaxPool3d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(128, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
        )
      )
    )
    (decoders): ModuleList(
      (0): Decoder(
        (upsampling): InterpolateUpsampling()
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(384, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
        )
      )
      (1): Decoder(
        (upsampling): InterpolateUpsampling()
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(192, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
        )
      )
      (2): Decoder(
        (upsampling): InterpolateUpsampling()
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(96, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1))
            (ReLU): ReLU(inplace=True)
          )
        )
      )
    )
    (final_conv): Conv3d(32, 5, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    (final_activation): Sigmoid()
  )
)
2022-05-16 15:14:01,714 [MainThread] INFO UNet3DTrainer - eval_score_higher_is_better: True
2022-05-16 15:14:02,548 [MainThread] INFO UNet3DTrainer - Training iteration [1/60000]. Epoch [0/199]
Traceback (most recent call last):
  File "/home/people/yasuda/.conda/envs/3dunet/bin/train3dunet", line 10, in <module>
    sys.exit(main())
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/train.py", line 29, in main
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/trainer.py", line 246, in fit
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/trainer.py", line 273, in train
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/trainer.py", line 402, in _forward_pass
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 168, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 178, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 86, in parallel_apply
    output.reraise()
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/model.py", line 82, in forward
    x = encoder(x)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/buildingblocks.py", line 237, in forward
    x = self.basic_module(x)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 590, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 585, in _conv_forward
    return F.conv3d(
RuntimeError: Given groups=1, weight of size [16, 5, 3, 3, 3], expected input[1, 1, 32, 64, 64] to have 5 channels, but got 1 channels instead

2022-05-16 15:24:56,884 [MainThread] INFO ConfigLoader - Using 'cuda:0' device
2022-05-16 15:24:56,884 [MainThread] INFO TrainingSetup - {'manual_seed': 0, 'model': {'name': 'UNet3D', 'in_channels': 5, 'out_channels': 5, 'layer_order': 'crg', 'f_maps': 32, 'num_groups': 4, 'final_sigmoid': True, 'is_segmentation': True}, 'trainer': {'checkpoint_dir': '/net/fs01/work01/yasuda/data/multi/', 'resume': None, 'pre_trained': None, 'validate_after_iters': 1000, 'log_after_iters': 100, 'max_num_epochs': 200, 'max_num_iterations': 60000, 'eval_score_higher_is_better': True}, 'optimizer': {'learning_rate': 0.0002, 'weight_decay': 0.0001}, 'loss': {'name': 'DiceLoss', 'weight': None, 'ignore_index': None}, 'eval_metric': {'name': 'MeanIoU', 'ignore_index': None}, 'lr_scheduler': {'name': 'MultiStepLR', 'milestones': [10, 30, 60], 'gamma': 0.2}, 'loaders': {'dataset': 'StandardHDF5Dataset', 'batch_size': 1, 'num_workers': 4, 'raw_internal_path': 'raw', 'label_internal_path': 'label', 'weight_internal_path': None, 'train': {'file_paths': ['/net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_4.h5', '/net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_7.h5'], 'slice_builder': {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}, 'transformer': {'raw': [{'name': 'Standardize'}, {'name': 'RandomFlip'}, {'name': 'RandomRotate90'}, {'name': 'RandomRotate', 'axes': [[2, 1]], 'angle_spectrum': 15, 'mode': 'reflect'}, {'name': 'ElasticDeformation', 'spline_order': 3}, {'name': 'RandomContrast'}, {'name': 'AdditiveGaussianNoise'}, {'name': 'AdditivePoissonNoise'}, {'name': 'ToTensor', 'expand_dims': True}], 'label': [{'name': 'RandomFlip'}, {'name': 'RandomRotate90'}, {'name': 'RandomRotate', 'axes': [[2, 1]], 'angle_spectrum': 15, 'mode': 'reflect'}, {'name': 'ElasticDeformation', 'spline_order': 0}, {'name': 'ToTensor', 'expand_dims': True}]}}, 'val': {'file_paths': ['/net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_4.h5', '/net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_7.h5'], 'slice_builder': {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}, 'transformer': {'raw': [{'name': 'Standardize'}, {'name': 'ToTensor', 'expand_dims': True}], 'label': [{'name': 'ToTensor', 'expand_dims': True}]}}}, 'device': device(type='cuda', index=0)}
2022-05-16 15:24:56,884 [MainThread] INFO TrainingSetup - Seed the RNG for all devices with 0
2022-05-16 15:24:58,388 [MainThread] INFO UNet3DTrainer - Using 4 GPUs for training
2022-05-16 15:24:58,388 [MainThread] INFO UNet3DTrainer - Sending the model to 'cuda:0'
2022-05-16 15:25:00,729 [MainThread] INFO UNet3DTrainer - Number of learnable params 4082741
2022-05-16 15:25:00,729 [MainThread] INFO Dataset - Creating training and validation set loaders...
2022-05-16 15:25:01,645 [MainThread] INFO HDF5Dataset - Loading train set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_4.h5...
2022-05-16 15:25:02,157 [MainThread] INFO HDF5Dataset - Input stats: min=0, max=255, mean=129.334027973919, std=6.1305032261307915
2022-05-16 15:25:02,180 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:25:02,515 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:25:02,517 [MainThread] INFO HDF5Dataset - Loading train set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/train/split_R_7.h5...
2022-05-16 15:25:02,981 [MainThread] INFO HDF5Dataset - Input stats: min=1, max=217, mean=129.28665717193536, std=5.647814388387516
2022-05-16 15:25:03,004 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:25:03,222 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:25:03,230 [MainThread] INFO HDF5Dataset - Loading val set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_4.h5...
2022-05-16 15:25:03,693 [MainThread] INFO HDF5Dataset - Input stats: min=0, max=255, mean=129.334027973919, std=6.1305032261307915
2022-05-16 15:25:03,717 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:25:03,879 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:25:03,881 [MainThread] INFO HDF5Dataset - Loading val set from: /net/fs01/work01/yasuda/data/221x1891x1891/R/val/split_R_7.h5...
2022-05-16 15:25:04,334 [MainThread] INFO HDF5Dataset - Input stats: min=1, max=217, mean=129.28665717193536, std=5.647814388387516
2022-05-16 15:25:04,358 [MainThread] INFO Dataset - Slice builder config: {'name': 'SliceBuilder', 'patch_shape': [32, 64, 64], 'stride_shape': [8, 16, 16]}
2022-05-16 15:25:04,539 [MainThread] INFO HDF5Dataset - Number of patches: 34225
2022-05-16 15:25:04,541 [MainThread] INFO Dataset - Number of workers for train/val dataloader: 4
2022-05-16 15:25:04,542 [MainThread] INFO Dataset - 4 GPUs available. Using batch_size = 4 * 1
2022-05-16 15:25:04,542 [MainThread] INFO Dataset - Batch size for train/val loader: 4
2022-05-16 15:25:04,543 [MainThread] INFO UNet3DTrainer - DataParallel(
  (module): UNet3D(
    (encoders): ModuleList(
      (0): Encoder(
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(5, 16, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 16, eps=1e-05, affine=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(16, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 32, eps=1e-05, affine=True)
          )
        )
      )
      (1): Encoder(
        (pooling): MaxPool3d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 32, eps=1e-05, affine=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(32, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 64, eps=1e-05, affine=True)
          )
        )
      )
      (2): Encoder(
        (pooling): MaxPool3d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 64, eps=1e-05, affine=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(64, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 128, eps=1e-05, affine=True)
          )
        )
      )
      (3): Encoder(
        (pooling): MaxPool3d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 128, eps=1e-05, affine=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(128, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 256, eps=1e-05, affine=True)
          )
        )
      )
    )
    (decoders): ModuleList(
      (0): Decoder(
        (upsampling): InterpolateUpsampling()
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(384, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 128, eps=1e-05, affine=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 128, eps=1e-05, affine=True)
          )
        )
      )
      (1): Decoder(
        (upsampling): InterpolateUpsampling()
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(192, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 64, eps=1e-05, affine=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 64, eps=1e-05, affine=True)
          )
        )
      )
      (2): Decoder(
        (upsampling): InterpolateUpsampling()
        (basic_module): DoubleConv(
          (SingleConv1): SingleConv(
            (conv): Conv3d(96, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 32, eps=1e-05, affine=True)
          )
          (SingleConv2): SingleConv(
            (conv): Conv3d(32, 32, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)
            (ReLU): ReLU(inplace=True)
            (groupnorm): GroupNorm(4, 32, eps=1e-05, affine=True)
          )
        )
      )
    )
    (final_conv): Conv3d(32, 5, kernel_size=(1, 1, 1), stride=(1, 1, 1))
    (final_activation): Sigmoid()
  )
)
2022-05-16 15:25:04,543 [MainThread] INFO UNet3DTrainer - eval_score_higher_is_better: True
2022-05-16 15:25:05,402 [MainThread] INFO UNet3DTrainer - Training iteration [1/60000]. Epoch [0/199]
Traceback (most recent call last):
  File "/home/people/yasuda/.conda/envs/3dunet/bin/train3dunet", line 10, in <module>
    sys.exit(main())
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/train.py", line 29, in main
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/trainer.py", line 246, in fit
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/trainer.py", line 273, in train
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/trainer.py", line 402, in _forward_pass
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 168, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 178, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 86, in parallel_apply
    output.reraise()
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/model.py", line 82, in forward
    x = encoder(x)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/pytorch3dunet-1.3.3-py3.9.egg/pytorch3dunet/unet3d/buildingblocks.py", line 237, in forward
    x = self.basic_module(x)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 590, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/people/yasuda/.conda/envs/3dunet/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 585, in _conv_forward
    return F.conv3d(
RuntimeError: Given groups=1, weight of size [16, 5, 3, 3, 3], expected input[1, 1, 32, 64, 64] to have 5 channels, but got 1 channels instead

